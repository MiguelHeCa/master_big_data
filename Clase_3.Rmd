---
title: "Clase 3"
author: "Miguel Hernández"
date: "11/6/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Análisis de correspondencias


¿Será adecuado pensar en ajustar un modelo Factorial?

Comunalidades próximas a 1

```{r}
materias = foreign::read.spss("data/Ciencias-Letras TOY EJEMPLO.sav",
                              to.data.frame = T)
```

```{r}
mat_corr = cor(materias)
```

```{r}
corrplot::corrplot(mat_corr)
```

```{r}
psych::principal(materias, nfactors = 2)
```


La matriz de correlaciones reproducidas sirve para ver si existe un factorial. Si sale 

Factores comunes 

Solución sin rotar


Modelo $a_{ij}: \mathrm{saturaciones}$

$$X_i = a_{i1}F_1 + a_{i2}F_2 + d_iU_i$$

Subíndice $i$ denota **Variable**.
Subíndice $j$ denota **Factor**.

F1: ciencias ???, F2: letras ???


Matemáticas = 0.973 C + 0.158 L + 0.047

La variabilidad $a^2_{ij}$ es el auto valor.

1.967 valor correspondiente al vector propio del F1
1.939 valor correspondiente al vector propio del F2

## Análisis factorial de correspondencias

Se usa para categórico, encuestas, etc.

Importantes diferencias con los métodos biplot.

Cosas en común.

Se trabaja con **tablas de contingencia**

El análisis de correspondencias es un método que nos permite describir sistemáticamente una tabla de contingencia en la que un conjunto de individuos homogéneos se clasifica de acuerdo con dos criterios (o variables categóricas).

$i$ categoría genérica
$I$ máximo número de categorías

$j$ categoría genérica
$J$ máximo número de categorías

$$
f_{i\bullet} = \displaystyle \sum^J_{j = 1}f_{ij} \quad 
f_{\bullet j} = \displaystyle \sum^I_{i = 1}f_{ij} \quad
$$

$$
n = f_{\bullet\bullet} =
\displaystyle \sum^I_{i=1}\sum^J_{j=1}f_{ij} =
\displaystyle \sum^J_{j = 1}f_{\bullet j} = 
\displaystyle \sum^I_{i = 1}f_{i \bullet}
$$

La estadística está menos desarrollada para variables categóricas, por eso este análisis es el más utilizado.

AFC

Benzecri 1973 propone el AFC como una técnica *multivariante* para representar las filas y las columnas de una tabla de contingencia como puntos de un espacio vectorial de baja dimensión eneel cual se pueden iterpretar las posiciones de los puntos.

Albert FIGI (grupo de trabajo. )
Técnica multivariante para estudiar relaciones de dependencia entre variables categóricas a partir de una tabla de contingencia



El objetivo del análisis de correspondencias es hacer gráficos de dispersión (puntos) biespacial (dos ejes) para las tablas de correspondencias.

Solo se examina la información nominal de ambas variables.

No se hace ninguna suposición acerca de la distancia o el orden entre las categorías de la misma variable.

test chi^2 no distingue entre una variable nominal y ordinal. las operaciones son conmutativas y por lo tanto no captura el orden.

El AFC es un método de extracción de variables latentes cuantitativas a partir de variables cualitativas originales

Margen activo = Totales marginales

Conceptos básicos
* Perfiles
* Masa
* Distancia ji-cuadrado
* Inercia

## Perfil

La distribución de frecuencias relativas de una línea de la tabla en relación a su total marginal

$$
\begin{pmatrix}
8 & 7 & 5 & 2 & 3
\end{pmatrix} 25 \quad \mathrm{Total \ marginal} \\
$$

$$
\mathrm{Perfil \ fila} \quad \begin{pmatrix}
^8/_{25} & ^7/_{25} & ^5/_{25} & ^2/_{25} & ^3/_{25}
\end{pmatrix}
$$

En forma mamona:



```{r}
datos = data.frame(
  v0 = c("ind1", "ind2", "ind3"),
  n = c(80, 160, 85),
  o = c(30, 60, 20),
  Total = c(110, 220, 105)
)

```

El valor del chi^2, mayor a 0,05 es totalmente independiente. Si sale asociación se puede pintar correctamente el gráfico. Pero si no hay significación, no tiene sentido tratar de explicarla.

```{r}
datos2 = data.frame(
  edo_civil = c("Soltero", "Casado", "Otro")
)
```

a cada perfil (fila o columna) se le asigna una masa que es el cociente entre el total marginal de la línea (fila o columna) y el total global.

Categorías alejadas del centro de gravedad (centroide) indican que su masa en el estudio es pequeña.

Todo lo muy frecuente queda dentro de un análisis de frecuencia. En un AFC, las menos frecuencias determinan los factores.

masa, peso, importancia

masa del i-ésimo perfil fila
$$r_i = \frac{f_{i\bullet}}{n}$$

masa del j-ésimo perfil columna
$$c_j = \frac{f_{\bullet j}}{n}$$

En un biplot a todos los elementos se les da la misma masa.

chi^2 están relacionadas




